<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hora do QA</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Qual framework você prefere?</h1>
    
    <form action="#" method="POST" class="poll-form">
      
      <div class="option">
        <input type="radio" id="robot" name="framework" value="Robot Framework" required>
        <label for="robot">Robot Framework</label>
      </div>
      
      <div class="option">
        <input type="radio" id="selenium" name="framework" value="Selenium" required>
        <label for="selenium">Selenium</label>
      </div>
      
      <div class="option">
        <input type="radio" id="cypress" name="framework" value="Cypress" required>
        <label for="cypress">Cypress</label>
      </div>
      
      <div class="option">
        <input type="radio" id="playwright" name="framework" value="Playwright" required>
        <label for="playwright">Playwright</label>
      </div>
      
      <button type="submit">Enviar</button>
    </form>

    <div class="thank-you-message">
      <p>Obrigado por participar da enquete!</p>
    </div>
  </div>

  <script>
    document.getElementById('poll-form').addEventListener('submit', async function (event) {
      event.preventDefault();
      
      const selectedFramework = document.querySelector('input[name="framework"]:checked').value;
      
      const response = await fetch('http://localhost:3000/enquete', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ framework: selectedFramework }),
      });

      if (response.ok) {
        document.getElementById('thank-you-message').style.display = 'block';
        fetchResults();
      }
    });

    async function fetchResults() {
      const response = await fetch('http://localhost:3000/resultados');
      const results = await response.json();
      
      const resultsList = document.getElementById('results-list');
      resultsList.innerHTML = '';

      results.forEach(result => {
        const listItem = document.createElement('li');
        listItem.textContent = `${result.framework}: ${result.votos} votos`;
        resultsList.appendChild(listItem);
      });
    }

    // Carregar resultados quando a página for carregada
    fetchResults();
  </script>
</body>
</html>
